const content = {
  es: {
    meta: { lang: "es", title: "Camille & Juan — Boda" },
    brandTitle: "Camille & Juan",
    brandSubtitle: "Celebración de boda",
    navToggle: "Abrir menú",
    navHome: "Inicio",
    navStory: "Nuestra historia",
    navSchedule: "Agenda",
    navVenue: "Lugar & Viaje",
    navCity: "Bogotá",
    navRsvp: "RSVP",
    navRegistry: "Regalos",
    navFaq: "FAQ",
    navContact: "Contacto",
    heroEyebrow: "Nos casamos",
    heroTitle: "Camille & Juan",
    heroMeta: "Sábado, 25 de julio de 2026 · Bogotá, Colombia",
    heroText: "Un fin de semana de amor, amistad y celebración en las alturas.",
    heroCta: "Confirmar asistencia",
    heroSecondary: "Nuestra historia",
    storyEyebrow: "Nuestra historia",
    storyTitle: "De compartir unas tapas a un para siempre",
    storyIntro: "Momentos que nos trajeron hasta aquí.",
    scheduleEyebrow: "Agenda",
    scheduleTitle: "Un fin de semana para celebrar",
    scheduleIntro: "",
    venueEyebrow: "Lugar & viaje",
    venueTitle: "Nos vemos en Bogotá",
    venueIntro: "Todo lo que necesitas para planear tu visita.",
    venueName: "Club Campestre Los Arrayanes",
    venueAddress: "Autopista Norte Km 15, Bogotá, Colombia",
    venueDetails: "El Club Campestre Los Arrayanes ofrece un entorno natural y elegante para nuestra celebración, con vistas impresionantes y comodidades excepcionales.",
    travelTitle: "Consejos de viaje",
    cityEyebrow: "Bogotá",
    cityTitle: "Descubre Bogotá",
    cityIntro: "Una ciudad vibrante entre montañas, cultura y sabores.",
    cityHighlightsTitle: "Información útil",
    rsvpEyebrow: "RSVP",
    rsvpTitle: "Confirma tu asistencia",
    rsvpIntro: "",
    rsvpPerGuestNote: "(Por favor llena un formulario por invitado)",
    formName: "Nombre completo",
    formEmail: "Correo electrónico",
    formAttend: "¿Asistirás?",
    formSelectPlaceholder: "Selecciona una opción",
    formAttendYes: "Sí, allí estaré",
    formAttendNo: "No podré asistir",
    formCountry: "País de origen",
    formCountryPlaceholder: "Selecciona tu país",
    formDiet: "Restricciones alimentarias",
    formSubmit: "Enviar RSVP",
    formSuccessMessage: "¡Gracias! Tu respuesta ha sido enviada.",
    formNote: "",
    registryEyebrow: "Regalos",
    registryTitle: "Regalos",
    registryIntro: "Tu presencia es nuestro mejor regalo, pero si deseas obsequiarnos algo puedes traer efectivo o transferirnos.",
    registryBody: "Tu presencia es nuestro mejor regalo, pero si deseas obsequiarnos algo puedes traer efectivo o transferirnos.",
    registryCoLabel: "Cuenta Colombia",
    registryCoAccountHolder: "Titular:",
    registryCoIdType: "Tipo identificación:",
    registryCoIdNumber: "Nº de identificación:",
    registryCoBank: "Banco:",
    registryCoAccountType: "Tipo de cuenta:",
    registryCoAccountTypeValue: "Depósito Electrónico",
    registryCoAccountNumber: "Nº de cuenta Electrónica:",
    registryEuLabel: "IBAN Europa",
    registryBankName: "Bank Name and Address:",
    registryCorrespondent: "Correspondent BIC:",
    faqEyebrow: "FAQ",
    faqTitle: "Preguntas frecuentes",
    faqIntro: "Respuestas rápidas para planear tu visita.",
    contactEyebrow: "Contacto",
    contactTitle: "Mantente en contacto",
    contactIntro: "Nos encantará ayudarte con lo que necesites.",
    contactGalleryTitle: "Galería",
    contactDetails: "Para cualquier pregunta: jfimbett@gmail.com · WhatsApp +34 722 404 282",
    footerText: "Gracias por ser parte de nuestro día.",
    rsvpRecorded: "Información guardada.",
    storyTimeline: [
      { title: "2018", text: "Nos conocimos en Barcelona y conectamos entre vino, restaurantes y música en vivo." },
      { title: "2021", text: "Mudanza a París: conciertos, cenas largas y nuevos rincones favoritos." },
      { title: "2024", text: "Mayo: propuesta en Kioto. Diciembre: matrimonio civil en Saint-Pierre-d'Allevard." },
      { title: "2025", text: "Agosto: celebración en Cassel, Francia. Luna de miel en CDMX y Puerto Vallarta." },
      { title: "2026", text: "Boda en Colombia." }
    ],
    scheduleCards: [
      { time: "17:00 – 2:00", title: "Celebración de la boda", text: "Club Campestre Los Arrayanes - Autopista Norte Km 15, Bogotá<br><br>Ceremonia, recepción y fiesta durante la noche.<br><br><strong>Dress code:</strong> Cóctel o formal." }
    ],
    travelTips: [
      "Zonas de hotel recomendadas: Parque 93 / Chicó, Zona T / Zona Rosa / El Retiro, Usaquén, Zona G.",
      "Aeropuerto: El Dorado (BOG).",
      "Toma paracetamol si la altura te hace daño.",
      "Colombia es segura para turistas, pero aplica las mismas precauciones que en grandes ciudades europeas.",
      "Usa Uber para la mayoría de trayectos.",
      "Evita caminar largas distancias de noche.",
      "Si necesitas taxi, pídele al hotel que lo solicite.",
      "Consigue una e-sim para estar conectado.",
      "No aceptes nada de desconocidos.",
      "Para moverte entre ciudades, prefiere el avión: Colombia es grande.",
      "Ayudaremos a coordinar el transporte hacia y desde el lugar de la boda (fuera de Bogotá).",
      "Si vienes de fuera de Bogotá, es una excusa perfecta para visitar Colombia y Sudamérica."
    ],
    cityHighlights: [
      "Altitud: 2.600 m (no olvides hidratarte).",
      "Clima: días templados y noches frescas, lleva capas.",
      "Barrios recomendados: Usaquén y Chapinero.",
      "Plan cultural: Museo del Oro, Monserrate, restaurantes y bares.",
      "Transporte: Uber."
    ],
    registryCards: [],
    faqItems: [
      { q: "¿Cuál es el código de vestimenta?", a: "Formal o cóctel." },
      { q: "¿Hay transporte desde el hotel?", a: "Para invitados extranjeros, ayudaremos a coordinar un shuttle hacia y desde el lugar desde los hoteles o un área central. Si alguien desea salir antes, se pueden llamar Uber o taxis." },
      { q: "¿Puedo compartir fotos?", a: "¡Sí! Compartiremos un código QR en el evento para que todos puedan compartir sus fotos." }
    ]
  },
  fr: {
    meta: { lang: "fr", title: "Camille & Juan — Mariage" },
    brandTitle: "Camille & Juan",
    brandSubtitle: "Célébration de mariage",
    navToggle: "Ouvrir le menu",
    navHome: "Accueil",
    navStory: "Notre histoire",
    navSchedule: "Programme",
    navVenue: "Lieu & voyage",
    navCity: "Bogotá",
    navRsvp: "RSVP",
    navRegistry: "Cadeaux",
    navFaq: "FAQ",
    navContact: "Contact",
    heroEyebrow: "Nous nous marions",
    heroTitle: "Camille & Juan",
    heroMeta: "Samedi 25 juillet 2026 · Bogotá, Colombie",
    heroText: "Un week-end d'amour, d'amitié et de célébration en altitude.",
    heroCta: "Confirmer ma présence",
    heroSecondary: "Notre histoire",
    storyEyebrow: "Notre histoire",
    storyTitle: "De quelques tapas à pour toujours",
    storyIntro: "Les moments qui nous ont menés ici.",
    scheduleEyebrow: "Programme",
    scheduleTitle: "Un week-end pour célébrer",
    scheduleIntro: "",
    venueEyebrow: "Lieu & voyage",
    venueTitle: "On se retrouve à Bogotá",
    venueIntro: "Tout pour organiser votre venue.",
    venueName: "Club Campestre Los Arrayanes",
    venueAddress: "Autopista Norte Km 15, Bogotá, Colombie",
    venueDetails: "Le Club Campestre Los Arrayanes offre un cadre naturel et élégant pour notre célébration, avec des vues impressionnantes et des équipements exceptionnels.",
    travelTitle: "Conseils de voyage",
    cityEyebrow: "Bogotá",
    cityTitle: "Découvrir Bogotá",
    cityIntro: "Une ville vibrante entre montagnes, culture et saveurs.",
    cityHighlightsTitle: "Infos utiles",
    rsvpEyebrow: "RSVP",
    rsvpTitle: "Confirmez votre présence",
    rsvpIntro: "",
    rsvpPerGuestNote: "(Merci de remplir un formulaire par invité)",
    formName: "Nom complet",
    formEmail: "Email",
    formAttend: "Serez-vous présent(e) ?",
    formSelectPlaceholder: "Choisissez une option",
    formAttendYes: "Oui, je serai là",
    formAttendNo: "Je ne pourrai pas venir",
    formCountry: "Pays d'origine",
    formCountryPlaceholder: "Choisissez votre pays",
    formDiet: "Régime alimentaire",
    formSubmit: "Envoyer le RSVP",
    formSuccessMessage: "Merci ! Votre réponse a été envoyée.",
    formNote: "",
    registryEyebrow: "Cadeaux",
    registryTitle: "Cadeaux",
    registryIntro: "Votre présence est le plus beau cadeau, mais si vous souhaitez nous offrir quelque chose vous pouvez apporter du cash ou nous faire un virement.",
    registryBody: "Votre présence est le plus beau cadeau, mais si vous souhaitez nous offrir quelque chose vous pouvez apporter du cash ou nous faire un virement.",
    registryCoLabel: "Compte Colombie",
    registryCoAccountHolder: "Titulaire :",
    registryCoIdType: "Type d'identification :",
    registryCoIdNumber: "Nº d'identification :",
    registryCoBank: "Banque :",
    registryCoAccountType: "Type de compte :",
    registryCoAccountTypeValue: "Dépôt Électronique",
    registryCoAccountNumber: "Nº de compte Électronique :",
    registryEuLabel: "IBAN Europe",
    registryBankName: "Nom et adresse de la banque :",
    registryCorrespondent: "BIC Correspondant :",
    faqEyebrow: "FAQ",
    faqTitle: "Questions fréquentes",
    faqIntro: "Des réponses rapides pour votre visite.",
    contactEyebrow: "Contact",
    contactTitle: "Restons en contact",
    contactIntro: "On sera ravis de vous aider avec tout ce dont vous avez besoin.",
    contactGalleryTitle: "Galerie",
    contactDetails: "Pour toute question : jfimbett@gmail.com · WhatsApp +34 722 404 282",
    footerText: "Merci d'être à nos côtés.",
    rsvpRecorded: "Informations enregistrées.",
    storyTimeline: [
      { title: "2018", text: "Rencontre à Barcelone autour du vin, de restaurants et de musique live." },
      { title: "2021", text: "Installation à Paris : concerts, longues dîners et nouveaux coups de cœur." },
      { title: "2024", text: "Mai : demande à Kyoto. Décembre : mariage civil à Saint-Pierre-d'Allevard." },
      { title: "2025", text: "Août : célébration à Cassel, France. Lune de miel à Mexico et Puerto Vallarta." },
      { title: "2026", text: "Mariage en Colombie." }
    ],
    scheduleCards: [
      { time: "17:00 – 2:00", title: "Célébration du mariage", text: "Club Campestre Los Arrayanes - Autopista Norte Km 15, Bogotá<br><br>Cérémonie, réception et fête jusqu'au bout de la nuit.<br><br><strong>Dress code :</strong> Cocktail ou formel." }
    ],
    travelTips: [
      "Zones d’hôtels recommandées : Parque 93 / Chicó, Zona T / Zona Rosa / El Retiro, Usaquén, Zona G.",
      "Aéroport : El Dorado (BOG).",
      "Prenez du paracétamol si l’altitude vous affecte.",
      "La Colombie est sûre pour les touristes, mais adoptez les mêmes précautions que dans les grandes villes européennes.",
      "Utilisez Uber pour la plupart des déplacements.",
      "Évitez de marcher longtemps la nuit.",
      "Si vous avez besoin d’un taxi, demandez à l’hôtel de le réserver.",
      "Prenez une e-sim pour rester connecté.",
      "N’acceptez rien de la part d’inconnus.",
      "Pour voyager entre villes, privilégiez l’avion : la Colombie est vaste.",
      "Nous aiderons à organiser le transport vers et depuis le lieu du mariage (hors Bogotá).",
      "Si vous venez de l’extérieur de Bogotá, c’est une occasion idéale de visiter la Colombie et l’Amérique du Sud."
    ],
    cityHighlights: [
      "Altitude : 2 600 m (pensez à bien vous hydrater).",
      "Climat : journées douces, soirées fraîches, prévoyez une veste.",
      "Quartiers : Usaquén et Chapinero.",
      "Culture : Museo del Oro, Monserrate, restaurants et bars.",
      "Transport : Uber."
    ],
    registryCards: [],
    faqItems: [
      { q: "Quel est le dress code ?", a: "Formel ou cocktail." },
      { q: "Y a-t-il un transport depuis l'hôtel ?", a: "Pour les invités étrangers, nous aiderons à organiser une navette vers et depuis le lieu à partir des hôtels ou d'une zone centrale. Si quelqu'un souhaite partir plus tôt, Uber ou des taxis peuvent être appelés." },
      { q: "Puis-je partager des photos ?", a: "Oui ! Nous partagerons un QR code lors de l'événement pour que tout le monde puisse partager ses photos." }
    ]
  },
  en: {
    meta: { lang: "en", title: "Camille & Juan — Wedding" },
    brandTitle: "Camille & Juan",
    brandSubtitle: "Wedding celebration",
    navToggle: "Open menu",
    navHome: "Home",
    navStory: "Our story",
    navSchedule: "Schedule",
    navVenue: "Venue & travel",
    navCity: "Bogotá",
    navRsvp: "RSVP",
    navRegistry: "Gifts",
    navFaq: "FAQ",
    navContact: "Contact",
    heroEyebrow: "We're getting married",
    heroTitle: "Camille & Juan",
    heroMeta: "Saturday, July 25, 2026 · Bogotá, Colombia",
    heroText: "A weekend of love, friendship and celebration in the heights.",
    heroCta: "RSVP",
    heroSecondary: "Our story",
    storyEyebrow: "Our story",
    storyTitle: "From sharing some tapas to forever",
    storyIntro: "Moments that brought us here.",
    scheduleEyebrow: "Schedule",
    scheduleTitle: "A weekend to celebrate",
    scheduleIntro: "",
    venueEyebrow: "Venue & travel",
    venueTitle: "See you in Bogotá",
    venueIntro: "Everything you need to plan your visit.",
    venueName: "Club Campestre Los Arrayanes",
    venueAddress: "Autopista Norte Km 15, Bogotá, Colombia",
    venueDetails: "Club Campestre Los Arrayanes offers a natural and elegant setting for our celebration, with stunning views and exceptional amenities.",
    travelTitle: "Travel tips",
    cityEyebrow: "Bogotá",
    cityTitle: "Discover Bogotá",
    cityIntro: "A vibrant city between mountains, culture, and flavors.",
    cityHighlightsTitle: "Helpful info",
    rsvpEyebrow: "RSVP",
    rsvpTitle: "Confirm your attendance",
    rsvpIntro: "",
    rsvpPerGuestNote: "(Please fill one form per guest)",
    formName: "Full name",
    formEmail: "Email",
    formAttend: "Will you attend?",
    formSelectPlaceholder: "Select an option",
    formAttendYes: "Yes, I will be there",
    formAttendNo: "Sorry, I can't make it",
    formCountry: "Country of origin",
    formCountryPlaceholder: "Select your country",
    formDiet: "Dietary restrictions",
    formSubmit: "Submit RSVP",
    formSuccessMessage: "Thank you! Your response has been submitted.",
    formNote: "",
    registryEyebrow: "Gifts",
    registryTitle: "Gifts",
    registryIntro: "Your presence is our best gift, but if you would like to gift us something you can bring cash or wire transfer it to us.",
    registryBody: "Your presence is our best gift, but if you would like to gift us something you can bring cash or wire transfer it to us.",
    registryCoLabel: "Colombian account",
    registryCoAccountHolder: "Account holder:",
    registryCoIdType: "ID type:",
    registryCoIdNumber: "ID number:",
    registryCoBank: "Bank:",
    registryCoAccountType: "Account type:",
    registryCoAccountTypeValue: "Electronic Deposit",
    registryCoAccountNumber: "Electronic account number:",
    registryEuLabel: "European IBAN",
    registryBankName: "Bank Name and Address:",
    registryCorrespondent: "Correspondent BIC:",
    faqEyebrow: "FAQ",
    faqTitle: "Frequently asked questions",
    faqIntro: "Quick answers to plan your visit.",
    contactEyebrow: "Contact",
    contactTitle: "Stay in touch",
    contactIntro: "We'd love to help you with anything you need.",
    contactGalleryTitle: "Gallery",
    contactDetails: "For any questions: jfimbett@gmail.com · WhatsApp +34 722 404 282",
    footerText: "Thank you for being part of our day.",
    rsvpRecorded: "Information saved.",
    storyTimeline: [
      { title: "2018", text: "We met in Barcelona and connected over wine, restaurants, and live music." },
      { title: "2021", text: "Moved to Paris: concerts, long dinners, and new favorite spots." },
      { title: "2024", text: "May: proposal in Kyoto. December: civil marriage in Saint-Pierre-d'Allevard." },
      { title: "2025", text: "August: celebration in Cassel, France. Honeymoon in Mexico City and Puerto Vallarta." },
      { title: "2026", text: "Wedding in Colombia." }
    ],
    scheduleCards: [
      { time: "5:00 PM – 2:00 AM", title: "Wedding celebration", text: "Club Campestre Los Arrayanes - Autopista Norte Km 15, Bogotá<br><br>Ceremony, reception, and party through the night.<br><br><strong>Dress code:</strong> Cocktail or formal." }
    ],
    travelTips: [
      "Recommended hotel areas: Parque 93 / Chicó, Zona T / Zona Rosa / El Retiro, Usaquén, Zona G.",
      "Airport: El Dorado (BOG).",
      "Take paracetamol if the altitude affects you.",
      "Colombia is safe for tourists, but follow the same precautions as in large European capitals.",
      "Use Uber for most transportation.",
      "Avoid long walks at night.",
      "If you need a taxi, ask the hotel to request it for you.",
      "Get an e-sim to stay connected.",
      "Do not accept anything from strangers.",
      "For intercity travel, fly—Colombia is a large country.",
      "We will help arrange transportation to and from the wedding (outside Bogotá).",
      "If you're traveling from outside Bogotá, it’s a perfect excuse to visit Colombia and South America."
    ],
    cityHighlights: [
      "Altitude: 2,600 m (stay hydrated).",
      "Weather: mild days, cool nights—bring layers.",
      "Neighborhoods: Usaquén and Chapinero.",
      "Culture: Gold Museum, Monserrate, restaurants and bars.",
      "Transport: Uber."
    ],
    registryCards: [],
    faqItems: [
      { q: "What is the dress code?", a: "Formal or cocktail." },
      { q: "Is there transportation from hotels?", a: "For foreign guests, we will help arrange a shuttle to and from the venue from hotels or a central area. If anyone wants to leave earlier, Uber or taxis can be called." },
      { q: "Can I share photos?", a: "Yes! We will share a QR code at the event for everyone to share their photos." }
    ]
  }
};

const state = {
  lang: "es"
};

const $ = (selector, parent = document) => parent.querySelector(selector);
const $$ = (selector, parent = document) => Array.from(parent.querySelectorAll(selector));

const navToggle = $(".nav-toggle");
const navLinks = $(".nav-links");
const toast = $("#toast");

const setActiveLanguage = (lang) => {
  state.lang = lang;
  const data = content[lang];
  document.documentElement.lang = data.meta.lang;
  document.title = data.meta.title;

  $$('[data-i18n]').forEach((el) => {
    const key = el.getAttribute("data-i18n");
    if (data[key]) {
      el.textContent = data[key];
    }
  });

  renderTimeline(data.storyTimeline);
  renderCards("#scheduleCards", data.scheduleCards);
  renderList("#travelTips", data.travelTips);
  renderList("#cityHighlights", data.cityHighlights);
  renderFaq(data.faqItems);

  $$('.lang-tab').forEach((tab) => {
    const isActive = tab.dataset.lang === lang;
    tab.classList.toggle("is-active", isActive);
    tab.setAttribute("aria-selected", String(isActive));
  });
};

const renderTimeline = (items) => {
  const container = $("#storyTimeline");
  container.innerHTML = items
    .map(
      (item) => {
        const year = String(item.title);
        if (year === "2026") {
          return `
      <div class="card timeline-item reveal">
        <strong>${item.title}</strong>
        <span class="card-text timeline-summary-text">${item.text}</span>
      </div>
    `;
        }
        return `
      <details class="card timeline-item reveal">
        <summary class="timeline-summary">
          <strong>${item.title}</strong>
          <span class="card-text timeline-summary-text">${item.text}</span>
        </summary>
        <div class="timeline-panel">
          <img class="timeline-image" src="images/${year}_pic.jpeg" alt="" aria-hidden="true" />
          <p class="card-text">${item.text}</p>
        </div>
      </details>
    `;
      }
    )
    .join("");
};

const renderCards = (selector, items) => {
  const container = $(selector);
  container.innerHTML = items
    .map(
      (item) => `
      <article class="card reveal">
        <p class="card-meta">${item.time ?? ""}</p>
        <h3>${item.title}</h3>
        <p class="card-text">${item.text}</p>
      </article>
    `
    )
    .join("");
};

const renderList = (selector, items) => {
  const container = $(selector);
  container.innerHTML = items.map((tip) => `<li>${tip}</li>`).join("");
};

const renderFaq = (items) => {
  const container = $("#faqAccordion");
  container.innerHTML = items
    .map(
      (item, index) => `
      <div class="accordion-item">
        <button class="accordion-header" type="button" aria-expanded="false">
          ${item.q}
          <span class="accordion-icon">+</span>
        </button>
        <div class="accordion-panel">${item.a}</div>
      </div>
    `
    )
    .join("");
};

const showToast = (message) => {
  toast.textContent = message;
  toast.classList.add("is-visible");
  setTimeout(() => toast.classList.remove("is-visible"), 2500);
};


const setupAccordion = () => {
  $$('#faqAccordion .accordion-item').forEach((item) => {
    const header = $(".accordion-header", item);
    header.addEventListener("click", () => {
      const isOpen = item.classList.toggle("is-open");
      header.setAttribute("aria-expanded", String(isOpen));
      $(".accordion-icon", item).textContent = isOpen ? "–" : "+";
    });
  });
};

const setupReveal = () => {
  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add("is-visible");
          observer.unobserve(entry.target);
        }
      });
    },
    { threshold: 0.2 }
  );

  $$(".reveal").forEach((el) => observer.observe(el));
};

const bindLangTabs = () => {
  $$('.lang-tab').forEach((tab) => {
    tab.addEventListener("click", () => {
      setActiveLanguage(tab.dataset.lang);
      setupAccordion();
      setupReveal();
    });
  });
};

const setupNav = () => {
  navToggle.addEventListener("click", () => {
    const isOpen = navLinks.classList.toggle("is-open");
    navToggle.setAttribute("aria-expanded", String(isOpen));
  });

  $$('.nav-links a').forEach((link) => {
    link.addEventListener("click", () => {
      navLinks.classList.remove("is-open");
      navToggle.setAttribute("aria-expanded", "false");
    });
  });
};

const setupForm = () => {
  const form = $("#rsvpForm");
  const notification = $("#successBanner");
  const closeBtn = $("#closeBanner");

  if (closeBtn && notification) {
    closeBtn.addEventListener("click", () => {
      notification.classList.remove("is-visible");
      notification.setAttribute("aria-hidden", "true");
    });
  }

  form.addEventListener("submit", () => {
    // Show notification after short delay to allow form to submit to iframe
    setTimeout(() => {
      form.reset();
      if (notification) {
        notification.classList.add("is-visible");
        notification.setAttribute("aria-hidden", "false");
      }
    }, 500);
  });
};

const setupGalleryCarousel = () => {
  $$('[data-carousel]').forEach((carousel) => {
    const images = $$(".carousel-image", carousel);
    const prevBtn = $(".carousel-btn.prev", carousel);
    const nextBtn = $(".carousel-btn.next", carousel);
    if (!images.length) {
      return;
    }

    let index = images.findIndex((img) => img.classList.contains("is-active"));
    if (index < 0) {
      index = 0;
    }

    const show = (nextIndex) => {
      const prevIndex = (nextIndex - 1 + images.length) % images.length;
      const nextIndexWrapped = (nextIndex + 1) % images.length;
      images.forEach((img, i) => {
        img.classList.toggle("is-active", i === nextIndex);
        img.classList.toggle("is-prev", i === prevIndex);
        img.classList.toggle("is-next", i === nextIndexWrapped);
        img.classList.toggle("is-hidden", i !== nextIndex && i !== prevIndex && i !== nextIndexWrapped);
      });
      index = nextIndex;
    };

    const goNext = () => show((index + 1) % images.length);
    const goPrev = () => show((index - 1 + images.length) % images.length);

    let timerId = null;
    const startAuto = () => {
      if (!timerId) {
        timerId = setInterval(goNext, 4000);
      }
    };
    const stopAuto = () => {
      if (timerId) {
        clearInterval(timerId);
        timerId = null;
      }
    };

    if (nextBtn) {
      nextBtn.addEventListener("click", goNext);
    }

    if (prevBtn) {
      prevBtn.addEventListener("click", goPrev);
    }

    carousel.addEventListener("mouseenter", stopAuto);
    carousel.addEventListener("mouseleave", startAuto);
    carousel.addEventListener("focusin", stopAuto);
    carousel.addEventListener("focusout", startAuto);
    show(index);
    startAuto();
  });
};

const init = () => {
  setActiveLanguage(state.lang);
  bindLangTabs();
  setupNav();
  setupForm();
  setupAccordion();
  setupReveal();
  setupGalleryCarousel();
};

init();
